<template>
  <require from="./date-format"></require>

  <section class="au-animate">
    <h2>
      <i class="fa fa-users"></i>
      <a href="#/jobs">Jobs</a> / Job Detail (#${job.id})
    </h2>

    <div class="pure-g">
      <div class="pure-u-1-4">
        <table class="pure-table">
          <tr><th>Customer</th><td>${job.client_name}</td></tr>
          <tr><th>User</th><td>${job.user_name}</td></tr>
          <tr><th>Folder</th><td>${job.folder_name}</td></tr>
          <tr><th>Job Created</th><td>${job.created_date | dateFormat:'ddd M/D/YYYY hh:mm:ss'} UTC</td></tr>
        </table>
      </div>

      <div class="pure-u-3-4">
        <table class="pure-table">
          <thead>
            <tr>
              <th>status</th>
              <th>count</th>
            </tr>
          </thead>
          <tbody>
            <tr repeat.for="status of statuses">
              <td>${status.name}</td>
              <td>${status.value}</td>
            </tr>
            <tr>
              <td>TOTAL:</td>
              <td>${totalItems}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <br/>
    <br/>
    
    <div class="toolbar">
      <a click.trigger="refreshJobItems()" style="cursor:pointer;">
        <i class="fa fa-refresh"></i>
        Refresh
      </a>
      <span style="font-size:15px;font-weight:normal;font-style:italic;padding-left:30px;">
        last updated: ${itemsLastUpdated | dateFormat:'h:mm:ss a'}
      </span>
    </div>

    <table class="pure-table">
      <thead>
        <tr>
          <th>id</th>
          <th>guid</th>
          <th>url</th>
          <th>status</th>
          <th>description</th>
          <th>date</th>
          <th>capture id</th>
        </tr>
      </thead>
      <tbody>
        <tr repeat.for="item of items"
          class="clickable-row"
          click.trigger="goToCapture(item.snapshot_id)">
          <td>${item.id}</a></td>
          <td>${item.guid}</td>
          <td><a href="${item.item_url}" target="_blank">${item.item_url}</a></td>
          <td>${item.item_status}</td>
          <td>${item.item_status_description}</td>
          <td>${item.created_date  | dateFormat:'ddd M/d/YYYY hh:mm:ss'} UTC</td>
          <td><a href="https://portal.page-vault.com/#/snapshot/${item.snapshot_id}" target="_blank">${item.snapshot_id}</a></td>
        </tr>
      </tbody>
    </table>
  </section>
</template>
